"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var filter_helper=function(_CrowdinComponent){_inherits(filter_helper,_CrowdinComponent);var _super=_createSuper(filter_helper);function filter_helper(){var _this;_classCallCheck(this,filter_helper);_this=_super.call(this);_this.ALL="ALL";_this.ALL_UNTRANSLATED_FIRST="ALL_UNTRANSLATED_FIRST";_this.NOT_APPROVED_THIS_STEP_BASIC_WORKFLOW="NOT_APPROVED_THIS_STEP_BASIC_WORKFLOW";_this.NOT_APPROVED="NOT_APPROVED";_this.APPROVED="APPROVED";_this.NOT_TRANSLATED="NOT_TRANSLATED";_this.NEED_TO_BE_VOTED="NEED_TO_BE_VOTED";_this.TRANSLATED_BUT_NOT_APPROVED="TRANSLATED_BUT_NOT_APPROVED";_this.WITH_MACHINE_TRANSLATIONS="WITH_MACHINE_TRANSLATIONS";_this.TRANSLATED_BY_TM_AND_MT="TRANSLATED_BY_TM_AND_MT";_this.TRANSLATED_BY_TM="TRANSLATED_BY_TM";_this.TRANSLATED_BY_MT="TRANSLATED_BY_MT";_this.WITH_COMMENTS="WITH_COMMENTS";_this.WITHOUT_COMMENTS="WITHOUT_COMMENTS";_this.WITH_UNRESOLVED_ISSUES="WITH_UNRESOLVED_ISSUES";_this.WITH_UNRESOLVED_ISSUES_OF_CURRENT_LANGUAGE="WITH_UNRESOLVED_ISSUES_OF_CURRENT_LANGUAGE";_this.WITH_UNRESOLVED_ISSUES_OF_ALL_LANGUAGE="WITH_UNRESOLVED_ISSUES_OF_ALL_LANGUAGE";_this.WITH_QA_ISSUES="WITH_QA_ISSUES";_this.HIDDEN="HIDDEN";_this.CUSTOM_FILTER="CUSTOM_FILTER";_this.QA_ALL="QA_ALL";_this.QA_CATEGORY_EMPTY="CATEGORY_EMPTY";_this.QA_CATEGORY_VARIABLES="CATEGORY_VARIABLES";_this.QA_CATEGORY_TAGS="CATEGORY_TAGS";_this.QA_CATEGORY_PUNCTUATION="CATEGORY_PUNCTUATION";_this.QA_CATEGORY_SYMBOL_REGISTER="CATEGORY_SYMBOL_REGISTER";_this.QA_CATEGORY_SPACES="CATEGORY_SPACES";_this.QA_CATEGORY_SIZE="CATEGORY_SIZE";_this.QA_CATEGORY_SPECIAL_SYMBOLS="CATEGORY_SPECIAL_SYMBOLS";_this.QA_CATEGORY_WRONG_TRANSLATION="CATEGORY_WRONG_TRANSLATION";_this.QA_CATEGORY_SPELLCHECK="CATEGORY_SPELLCHECK";_this.QA_CATEGORY_ICU="CATEGORY_ICU";_this.QA_CATEGORY_TERMS="CATEGORY_TERMS";_this.QA_CATEGORY_DUPLICATE="CATEGORY_DUPLICATE";_this.QA_CATEGORY_NONE="CATEGORY_NONE";_this.QA_CATEGORY_CUSTOM_PREFIX="CATEGORY_CUSTOM_";_this.QA_CATEGORY_CUSTOM_OFFSET=1e3;_this.mainFilters=[[_this.ALL,_this.ALL_UNTRANSLATED_FIRST,_this.NOT_APPROVED_THIS_STEP_BASIC_WORKFLOW,_this.NOT_APPROVED],[_this.NOT_TRANSLATED,_this.NEED_TO_BE_VOTED,_this.TRANSLATED_BUT_NOT_APPROVED,_this.APPROVED],[_this.WITH_QA_ISSUES,_this.WITH_MACHINE_TRANSLATIONS,_this.WITH_COMMENTS,_this.WITHOUT_COMMENTS,_this.WITH_UNRESOLVED_ISSUES,_this.HIDDEN],[_this.CUSTOM_FILTER]];return _this}_createClass(filter_helper,[{key:"getFilterOptionsData",value:function getFilterOptionsData(){var self=this,categories=crowdin.editor.validator_categories,isAllowedStep=!crowdin.editor.stepTypeTranslate()&&!crowdin.editor.stepTypeTranslateByVendor()&&!crowdin.editor.isOutOfWorkflowEditorMode()&&!crowdin.editor.stepTypeCrowdsource();var isActiveQaCategory=function isActiveQaCategory(categoryName){return crowdin.editor.active_qa_categories.indexOf(self.getQaCategoryByCategoryName(categoryName))!==-1};var filterOptionsData={};filterOptionsData[this.ALL]={option:3,isAllowed:true,categoryTitle:_l("tasks.showStringsWithoutFiltering"),categoryLabel:_l("editor.showAll")};filterOptionsData[this.NOT_TRANSLATED]={option:2,isAllowed:crowdin.editor.modeTranslateProofread(),categoryTitle:_l("editor.showOnlyStringsWithoutTranslations"),categoryLabel:_l("generic.untranslated")};filterOptionsData[this.NEED_TO_BE_VOTED]={option:15,isAllowed:!crowdin.user.is_leader||!isAllowedStep,categoryTitle:_l("editor.showStringsThatAreAlreadyTranslated"),categoryLabel:_l("editor.needToBeVoted")};var notApprovedAllowed=false;if(!IS_ENTERPRISE&&crowdin.editor.modeTranslateProofread()||crowdin.editor.project.has_basic_workflow&&crowdin.editor.modeProofread()){notApprovedAllowed=true}filterOptionsData[this.TRANSLATED_BUT_NOT_APPROVED]={option:5,isAllowed:notApprovedAllowed,categoryTitle:_l("editor.showTranslatedButNotApproved"),categoryLabel:_l("settings.notApproved")};filterOptionsData[this.APPROVED]={option:4,isAllowed:crowdin.user.is_leader&&isAllowedStep,categoryTitle:_l("editor.showOnlyApproved"),categoryLabel:_l("generic.approved")};filterOptionsData[this.WITH_MACHINE_TRANSLATIONS]={isAllowed:!crowdin.editor.modeReview(),categoryLabel:_l("editor.machineTranslations")+(IS_MOBILE?"...":"")};filterOptionsData[this.TRANSLATED_BY_TM_AND_MT]={option:10,isAllowed:!crowdin.editor.modeReview(),subCategory:this.WITH_MACHINE_TRANSLATIONS,categoryTitle:_l("editor.showStringsByTMAndMT"),categoryLabel:_l("generic.all")};filterOptionsData[this.TRANSLATED_BY_TM]={option:30,isAllowed:!crowdin.editor.modeReview(),subCategory:this.WITH_MACHINE_TRANSLATIONS,categoryTitle:_l("editor.showStringsByTM"),categoryLabel:_l("editor.translatedByTM")};filterOptionsData[this.TRANSLATED_BY_MT]={option:31,isAllowed:!crowdin.editor.modeReview(),subCategory:this.WITH_MACHINE_TRANSLATIONS,categoryTitle:_l("editor.showStringsByMT"),categoryLabel:_l("editor.translatedByMT")};filterOptionsData[this.WITH_COMMENTS]={option:7,isAllowed:true,categoryTitle:_l("editor.showStringsWithComments"),categoryLabel:_l("editor.withComments")};filterOptionsData[this.WITHOUT_COMMENTS]={option:16,isAllowed:!crowdin.editor.modeReviewProofread()&&crowdin.editor.show_filter_for_kickstarter,categoryTitle:_l("editor.showStringsWithoutComments"),categoryLabel:_l("editor.stringsWithoutComments")};filterOptionsData[this.WITH_UNRESOLVED_ISSUES]={isAllowed:true,categoryLabel:_l("editor.withUnresolvedIssues")+(IS_MOBILE?"...":"")};filterOptionsData[this.WITH_UNRESOLVED_ISSUES_OF_ALL_LANGUAGE]={option:13,isAllowed:true,subCategory:this.WITH_UNRESOLVED_ISSUES,categoryTitle:_l("editor.showStringsWithUnresolvedIssues"),categoryLabel:crowdin.editor.modeReview()?_l("editor.ofAllSteps"):_l("editor.ofAllLanguages")};filterOptionsData[this.WITH_UNRESOLVED_ISSUES_OF_CURRENT_LANGUAGE]={option:17,isAllowed:true,subCategory:this.WITH_UNRESOLVED_ISSUES,categoryTitle:_l("editor.showStringsWithUnresolvedIssuesCurrentLanguage"),categoryLabel:crowdin.editor.modeReview()?_l("editor.ofCurrentStep"):_l("editor.ofCurrentLanguage")};filterOptionsData[this.WITH_QA_ISSUES]={isAllowed:crowdin.editor.modeTranslateProofread()&&crowdin.editor.active_qa_categories.length,categoryTitle:_l("editor.showStringsWithUnresolvedIssuesCurrentLanguage"),categoryLabel:_l("editor.qaIssues")+(IS_MOBILE?"...":"")};filterOptionsData[this.QA_CATEGORY_NONE]={divide:true,option:33,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread(),categoryLabel:categories.description[this.QA_CATEGORY_NONE]};filterOptionsData[this.QA_ALL]={option:18,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&crowdin.editor.active_qa_categories.length>1,categoryLabel:_l("generic.all")};filterOptionsData[this.QA_CATEGORY_EMPTY]={option:19,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_EMPTY),categoryLabel:categories.description[this.QA_CATEGORY_EMPTY]};filterOptionsData[this.QA_CATEGORY_VARIABLES]={option:20,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_VARIABLES),categoryLabel:categories.description[this.QA_CATEGORY_VARIABLES]};filterOptionsData[this.QA_CATEGORY_TAGS]={option:21,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_TAGS),categoryLabel:categories.description[this.QA_CATEGORY_TAGS]};filterOptionsData[this.QA_CATEGORY_PUNCTUATION]={option:22,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_PUNCTUATION),categoryLabel:categories.description[this.QA_CATEGORY_PUNCTUATION]};filterOptionsData[this.QA_CATEGORY_SYMBOL_REGISTER]={option:23,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_SYMBOL_REGISTER),categoryLabel:categories.description[this.QA_CATEGORY_SYMBOL_REGISTER]};filterOptionsData[this.QA_CATEGORY_SPACES]={option:24,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_SPACES),categoryLabel:categories.description[this.QA_CATEGORY_SPACES]};filterOptionsData[this.QA_CATEGORY_SIZE]={option:25,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_SIZE),categoryLabel:categories.description[this.QA_CATEGORY_SIZE]};filterOptionsData[this.QA_CATEGORY_SPECIAL_SYMBOLS]={option:26,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_SPECIAL_SYMBOLS),categoryLabel:categories.description[this.QA_CATEGORY_SPECIAL_SYMBOLS]};filterOptionsData[this.QA_CATEGORY_WRONG_TRANSLATION]={option:27,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_WRONG_TRANSLATION),categoryLabel:categories.description[this.QA_CATEGORY_WRONG_TRANSLATION]};filterOptionsData[this.QA_CATEGORY_SPELLCHECK]={option:28,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_SPELLCHECK),categoryLabel:categories.description[this.QA_CATEGORY_SPELLCHECK]};filterOptionsData[this.QA_CATEGORY_ICU]={option:29,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_ICU),categoryLabel:categories.description[this.QA_CATEGORY_ICU]};filterOptionsData[this.QA_CATEGORY_TERMS]={option:32,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_TERMS),categoryLabel:categories.description[this.QA_CATEGORY_TERMS]};filterOptionsData[this.QA_CATEGORY_DUPLICATE]={option:35,subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread()&&isActiveQaCategory(this.QA_CATEGORY_DUPLICATE),categoryLabel:categories.description[this.QA_CATEGORY_DUPLICATE]};filterOptionsData[this.HIDDEN]={option:6,isAllowed:crowdin.editor.modeTranslateProofread()&&crowdin.user.has_access_to_hidden_strings,categoryTitle:_l("editor.showStringsThatAreHiddenFromTranslators",{siteName:crowdin.editor.branding.name}),categoryLabel:_l("generic.hidden")};filterOptionsData[this.CUSTOM_FILTER]={option:12,isAllowed:true,categoryTitle:_l("editor.defineOwnFilteringAndSortingParams"),categoryLabel:_l("editor.advancedFilterD")};var customQaCategories=crowdin.editor.active_qa_categories.filter((function(category){return self.isCustomQaCheckCategory(category)}));for(var i in customQaCategories){var qaCheckKey=this.QA_CATEGORY_CUSTOM_PREFIX+customQaCategories[i];filterOptionsData[qaCheckKey]={option:customQaCategories[i],subCategory:this.WITH_QA_ISSUES,isAllowed:crowdin.editor.modeTranslateProofread(),categoryLabel:categories.description[customQaCategories[i]]}}if(crowdin.editor.project.has_basic_workflow&&crowdin.editor.approvingAvailable()&&crowdin.user.workflow_step_id>crowdin.editor.BASIC_WORKFLOW_PROOFREAD_STEP_ID){var proofreadStep=_.filter(crowdin.editor.workflow_proofread_steps,(function(item){return crowdin.user.workflow_step_id==item.id}))[0];filterOptionsData[this.NOT_APPROVED_THIS_STEP_BASIC_WORKFLOW]={option:34,isAllowed:true,categoryLabel:[["span",{key:this.NOT_APPROVED_THIS_STEP_BASIC_WORKFLOW+"part-1"},_l("settings.notApproved")],["span.muted",{key:this.NOT_APPROVED_THIS_STEP_BASIC_WORKFLOW+"part-2"}," (at "+proofreadStep.name+")"]]}}var defaultFilterLabel=[["span",{key:this.ALL_UNTRANSLATED_FIRST+"part-1"},_l("editor.allUntranslatedFirst")+" "],["span.muted",{key:this.ALL_UNTRANSLATED_FIRST+"part-2"}," ("+_l("generic.default")+")"]];var notApprovedAsDefaultFilter=crowdin.editor.stepTypeProofread()||crowdin.editor.stepTypeProofreadByVendor()||crowdin.editor.stepTypeSourceTextReview();if(notApprovedAsDefaultFilter){defaultFilterLabel=[["span",{key:this.NOT_APPROVED+"part-1"},_l("editor.notApproved")+" "],["span.muted",{key:this.NOT_APPROVED+"part-2"}," ("+_l("generic.default")+")"]]}filterOptionsData[this.ALL_UNTRANSLATED_FIRST]={option:0,isAllowed:true,categoryTitle:notApprovedAsDefaultFilter?_l("editor.showTranslatedButNotApproved"):_l("editor.defaultSiteFilterUntranslatedStringsAreFirst",{siteName:crowdin.editor.branding.name}),categoryLabel:defaultFilterLabel};return filterOptionsData}},{key:"getFilterOptionsDataBySubCategory",value:function getFilterOptionsDataBySubCategory(subCategory){var filterOptionsDataBySubCategory=[],filterOptionsData=this.getFilterOptionsData();for(var categoryName in filterOptionsData){if(filterOptionsData[categoryName].subCategory===subCategory){filterOptionsDataBySubCategory.push(filterOptionsData[categoryName])}}return filterOptionsDataBySubCategory}},{key:"getFilterOptionDataByOption",value:function getFilterOptionDataByOption(option){var filterOptionsData=this.getFilterOptionsData();for(var categoryName in filterOptionsData){if(filterOptionsData[categoryName].option===option){return filterOptionsData[categoryName]}}if(crowdin.editor.modeProofread()&&this.isCustomQaCheckCategory(option)&&!in_array(option,crowdin.editor.active_qa_categories)){return{option:option,isAllowed:false}}return undefined}},{key:"getQaCategoryByCategoryName",value:function getQaCategoryByCategoryName(validationCategory){var validationCategoryToCategoryNames={};validationCategoryToCategoryNames[this.QA_CATEGORY_EMPTY]=1;validationCategoryToCategoryNames[this.QA_CATEGORY_VARIABLES]=2;validationCategoryToCategoryNames[this.QA_CATEGORY_TAGS]=3;validationCategoryToCategoryNames[this.QA_CATEGORY_PUNCTUATION]=4;validationCategoryToCategoryNames[this.QA_CATEGORY_SYMBOL_REGISTER]=5;validationCategoryToCategoryNames[this.QA_CATEGORY_SPACES]=6;validationCategoryToCategoryNames[this.QA_CATEGORY_SIZE]=7;validationCategoryToCategoryNames[this.QA_CATEGORY_SPECIAL_SYMBOLS]=8;validationCategoryToCategoryNames[this.QA_CATEGORY_WRONG_TRANSLATION]=9;validationCategoryToCategoryNames[this.QA_CATEGORY_SPELLCHECK]=10;validationCategoryToCategoryNames[this.QA_CATEGORY_ICU]=11;validationCategoryToCategoryNames[this.QA_CATEGORY_TERMS]=12;validationCategoryToCategoryNames[this.QA_CATEGORY_DUPLICATE]=14;validationCategoryToCategoryNames[this.QA_CATEGORY_NONE]=13;return validationCategoryToCategoryNames[validationCategory]}},{key:"getSelectedFilterOption",value:function getSelectedFilterOption(){var currentFilterOptionData=this.getFilterOptionDataByOption(crowdin.user.get_texts_sort_order()),newFilter=crowdin.user.get_texts_sort_order();if(currentFilterOptionData&&!currentFilterOptionData.isAllowed){newFilter=0;if((currentFilterOptionData.option===4||currentFilterOptionData.option===5)&&!crowdin.user.is_leader){newFilter=15}if(currentFilterOptionData.option===15&&crowdin.user.is_leader){newFilter=5}if(this.isCustomQaCheckCategory(currentFilterOptionData.option)){newFilter=18}crowdin.phrases.sort_order(newFilter)}return newFilter}},{key:"isCustomQaCheckCategory",value:function isCustomQaCheckCategory(category){return category>this.QA_CATEGORY_CUSTOM_OFFSET}}]);return filter_helper}(CrowdinComponent);
