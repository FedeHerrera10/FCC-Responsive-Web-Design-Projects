"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var crowdin_textarea_highlight=function(){function crowdin_textarea_highlight(translation){_classCallCheck(this,crowdin_textarea_highlight);this.mappings=[];this.translation=translation}_createClass(crowdin_textarea_highlight,[{key:"addToMapping",value:function addToMapping(translationId,highlight){this.mappings=_objectSpread(_objectSpread({},this.mappings),{},_defineProperty({},crowdin.editor.mode,_objectSpread(_objectSpread({},this.mappings[crowdin.editor.mode]),{},_defineProperty({},translationId,highlight))))}},{key:"lightByTranslationId",value:function lightByTranslationId(translationId,$textarea){var highlightMapping=_.uniqWith(this.getMapping(translationId),_.isEqual);$textarea.highlightWithinTextarea({highlight:highlightMapping},crowdin.editor.modeReviewProofread()?"backdrop-side-view":"backdrop-comfortable-view")}},{key:"refreshIcuLight",value:function refreshIcuLight(translation){var markupReplacer=crowdin.phrases.markup_replacer(translation.id);var sourceString=crowdin.translation.getAppropriateSourceText(translation,"source");var icuHelper=new IcuHelper(sourceString);if(sourceString){sourceString=icuHelper.getModifiedString();var highlightedIcu=crowdin.helpers.translation.lightIcu(sourceString,true);crowdin.highlight.light(highlightedIcu,markupReplacer.tags,true);var highlightMapping=_.uniqWith(crowdin.highlight.mapping,_.isEqual);crowdin.translation.textarea_highlight.addToMapping(translation.id,highlightMapping)}}},{key:"getMapping",value:function getMapping(translationId){return this.mappings[crowdin.editor.mode]&&this.mappings[crowdin.editor.mode][translationId]||[]}}]);return crowdin_textarea_highlight}();
