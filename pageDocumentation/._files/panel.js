"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var AppsPanel=function(_React$Component){_inherits(AppsPanel,_React$Component);var _super=_createSuper(AppsPanel);function AppsPanel(){var _this;_classCallCheck(this,AppsPanel);_this=_super.call(this);_this.state=_this.getInitialState();return _this}_createClass(AppsPanel,[{key:"getInitialState",value:function getInitialState(){return{selected:null}}},{key:"componentDidMount",value:function componentDidMount(){var _this2=this;if(!this.props.modules.length){return}this.setState({selected:this.props.apps.getId(this.props.modules[0])});var _loop=function _loop(_i2,_this$props$modules2){var appModule=_this$props$modules2[_i2];_this2.props.apps.getJwtToken(appModule,(function(jwtToken){var id=_this2.props.apps.getId(appModule);var delimiter=appModule.iframe.location.url.indexOf("?")===-1?"?":"&";var params=_objectSpread(_objectSpread({},appModule.iframe.location.params),{},{jwtToken:jwtToken});var windowData={addon_key:appModule.identifier,key:id,url:appModule.iframe.location.url+delimiter+$.param(params),options:_objectSpread(_objectSpread({autoresize:false},appModule.iframe.data.app),{},{context:_this2.props.apps.getContext(),hostFrameOffset:1,jwtToken:jwtToken})};_this2.setupIframe(windowData)}))};for(var _i2=0,_this$props$modules2=this.props.modules;_i2<_this$props$modules2.length;_i2++){_loop(_i2,_this$props$modules2)}}},{key:"render",value:function render(){var _this3=this;var options=[];for(var _i4=0,_this$props$modules4=this.props.modules;_i4<_this$props$modules4.length;_i4++){var appModule=_this$props$modules4[_i4];options.push(["option",{value:this.props.apps.getId(appModule)},appModule.data.name])}return ReactCompile(["div.tab-pane",{id:"crowdin_apps_tab"},this.props.modules.length>1?["div.control-group no-margin",["div.controls",{style:{padding:"7px 15px"}},["select.input-block-level no-margin",{id:"right_panel_apps_dropdown",value:this.state.selected||Object.keys(this.props.modules)[0],onChange:function onChange(event){_this3.setState({selected:event.target.value})}}].concat(options)]]:null,["div.editor-pane-inner"].concat(_toConsumableArray(this.getTabsTpl()))])}},{key:"getTabsTpl",value:function getTabsTpl(){var result=[];for(var _i6=0,_this$props$modules6=this.props.modules;_i6<_this$props$modules6.length;_i6++){var appModule=_this$props$modules6[_i6];var id=this.props.apps.getId(appModule);var visible=this.state.selected===id;result.push(["div"+(visible?"":".hidden"),{id:id}])}return result}},{key:"setupIframe",value:function setupIframe(extension){var iframeParams=host.create(extension,(function(extensionId){}));var iframe=document.createElement("iframe");iframe.setAttribute("id",iframeParams.id);iframe.setAttribute("name",iframeParams.name);iframe.setAttribute("src",iframeParams.src);iframe.setAttribute("frameBorder",0);iframe.setAttribute("allow","camera;microphone");document.getElementById(extension.key).appendChild(iframe)}}]);return AppsPanel}(React.Component);
