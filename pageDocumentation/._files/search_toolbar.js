"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var SearchView=function(_React$Component){_inherits(SearchView,_React$Component);var _super=_createSuper(SearchView);function SearchView(){_classCallCheck(this,SearchView);return _super.apply(this,arguments)}_createClass(SearchView,[{key:"componentDidMount",value:function componentDidMount(){this.bindEvents()}},{key:"componentDidUpdate",value:function componentDidUpdate(){if(!crowdin.plugins.crowdin_custom_filter){return}crowdin.plugins.crowdin_custom_filter.rebind_action_button()}},{key:"render",value:function render(){return ReactCompile(["div.clearfix",["div.pull-right btn-toolbar actions-buttons",{style:{margin:"0 0 0 7px"}},this.getButtons()],["div",{style:{overflow:"hidden"}},["div.input-search-string"+(crowdin.phrases.query?" has-text":""),{id:"editor_search_bar_wrapper"},["input.input-block-level input-invisible",{id:"editor_search_bar",placeholder:crowdin.editor.isAllFilesSelected()?_l("editorMenu.searchInProject"):_l("editorMenu.searchInFile"),title:_l("editor.searchTextTranslationsAndContextHotkey",{hotkey:crowdin.hotkeys.get(crowdin.hotkeys.SEARCH_KEY)}),type:"text",tabIndex:1,defaultValue:crowdin.phrases.query}],["button.input-clear",{id:"close-search-box",href:"#",title:_l("generic.cancel"),tabIndex:-1}]]]])}},{key:"getButtons",value:function getButtons(){var result=[];if(crowdin.phrases.version==="html"){result.push(["button.btn btn-icon",{onClick:function onClick(){crowdin.phrases.load_view("basic")},key:"load_basic_phrases_view",title:_l("editor.loadBasicListView"),tabIndex:-1},["i.static-icon-list"]]);result.push(["button.btn btn-icon"+(crowdin.user.settings.html_strings_highlight?" active":""),{onClick:function onClick(){crowdin.user.settings.html_strings_highlight=!crowdin.user.settings.html_strings_highlight;crowdin.phrases.toggle_html_strings_highlight();crowdin.user.update_settings();crowdin.editor.view.setState({updatePhrases:false})},key:"html_strings_highlight_btn",title:_l("editor.highlightUntranslatedTranslatedAndApproved"),tabIndex:-1},["i.static-icon-highlight"]]);result.push(["button.btn btn-icon"+(crowdin.user.settings.html_editor_preview?" active":""),{onClick:function onClick(){if(!crowdin.phrases.source_doc){return}crowdin.user.settings.html_editor_preview=!crowdin.user.settings.html_editor_preview;crowdin.phrases.toggle_html_preview(true);crowdin.phrases.source_doc.dispatchEvent(new Event("toggle_html_preview"));crowdin.user.update_settings();crowdin.editor.view.setState({updatePhrases:false})},key:"source_file_preview",title:_l("editor.showTranslationPreview"),tabIndex:-1},["i.static-icon-eye"]]);if(crowdin.editor.file&&["docx","html"].indexOf(crowdin.editor.getBaseFileType())!==-1){result.push(["button.btn btn-icon"+(crowdin.phrases.zoom_enabled?" active":""),{onClick:function onClick(){if(!crowdin.phrases.source_doc){return}crowdin.phrases.zoom_enabled=!crowdin.phrases.zoom_enabled;crowdin.editor.view.setState({});var zoomEvent=new Event("zoom_level");crowdin.phrases.source_doc.dispatchEvent(zoomEvent)},type:"button",key:"docx_scale",title:_l("editor.scaleToggle"),tabIndex:-1},crowdin.phrases.zoom_enabled?["i.static-icon-zoom-out"]:["i.static-icon-zoom-in"]])}}else{var translation=crowdin.translation&&crowdin.translation.get_translation()||{};if(crowdin.editor.modeTranslate()&&(translation.has_html_preview||crowdin.editor.html_preview)){result.push(["button.btn btn-icon",{onClick:function onClick(){if(crowdin.editor.file.id==translation.file_id){crowdin.phrases.load_view("html")}else{crowdin.plugins.open_file.changeFile(translation.file_id)}},key:"load_extended_view",title:_l("editor.switchToWYSIWYGTranslationMode"),tabIndex:-1},["i.static-icon-list"]])}result.push(["div.btn-group",{id:"phrases-sort-order",key:"phrases-sort-order"},["button.btn btn-icon dropdown-toggle"+(crowdin.phrases.filter_index===0||crowdin.phrases.filter_index===3?"":" active"),{id:"filter-button",title:_l("editor.filterStrings"),tabIndex:-1,disabled:crowdin.phrases.filter_disabled},["i.static-icon-filter"]],this.getSortOrderOptionListTpl()]);crowdin.editor.project.has_advanced_workflow&&!crowdin.editor.isOutOfWorkflowEditorMode()&&result.push(["div.btn-group",{id:"phrases-step-options",key:"phrases-step-options"},["button.btn btn-icon dropdown-toggle"+(crowdin.phrases.workflow_step_status?" active":""),{id:"step-status-button",title:_l("editor.filterStrings"),tabIndex:-1,disabled:crowdin.phrases.filter_disabled},["i.static-icon-workflow"]],this.getStatusOptionListTpl()])}return result}},{key:"getSortOrderOptionListTpl",value:function getSortOrderOptionListTpl(){if(IS_MOBILE){return null}var additionalClasses=crowdin.editor.modeReviewProofread()?" pull-right":"";return["ul.dropdown-menu filter-holder"+additionalClasses,{id:"phrases-sort-order-options"},[FilterOptionsView]]}},{key:"getStatusOptionListTpl",value:function getStatusOptionListTpl(){if(IS_MOBILE){return null}var additionalClasses=crowdin.editor.modeReviewProofread()?" pull-right":"";return["ul.dropdown-menu filter-holder"+additionalClasses,{id:"step-status-options"},[StepOptionsView]]}},{key:"moveUpLeftPanel",value:function moveUpLeftPanel(){$("#left_panel").css("z-index",2)}},{key:"restoreLeftPanel",value:function restoreLeftPanel(){if(!$("#phrases-step-options").hasClass("open")&&!$("#phrases-sort-order").hasClass("open")){$("#left_panel").css("z-index",0)}}},{key:"show_phrases_filter",value:function show_phrases_filter(){if(IS_MOBILE){crowdin.editor.layout.showModalMenu("#phrases-sort-order-options")}else{this.moveUpLeftPanel();$("#phrases-sort-order").addClass("open")}}},{key:"hide_phrases_filter",value:function hide_phrases_filter(){if(IS_MOBILE){crowdin.editor.layout.hideModalMenu()}else{$("#phrases-sort-order").removeClass("open");this.restoreLeftPanel()}}},{key:"show_step_status_filter",value:function show_step_status_filter(){if(IS_MOBILE){crowdin.editor.layout.showModalMenu("#step-status-options")}else{this.moveUpLeftPanel();$("#phrases-step-options").addClass("open")}}},{key:"hide_step_status_filter",value:function hide_step_status_filter(){if(IS_MOBILE){crowdin.editor.layout.hideModalMenu()}else{$("#phrases-step-options").removeClass("open");this.restoreLeftPanel()}}},{key:"checkSubmenu",value:function checkSubmenu(element){return!!$(element).filter("a").parent(".dropdown-submenu").length}},{key:"bindEvents",value:function bindEvents(){var self=this;$(document).on("click","#filter-button",(function(event){if($(this).parent().hasClass("open")){self.hide_phrases_filter()}else{self.show_phrases_filter();if(!IS_MOBILE){$(document).on("click.editor_filter",(function(e){if(!self.checkSubmenu(e.target)){self.hide_phrases_filter();$(document).off(".editor_filter")}}))}}event.preventDefault()}));$(document).on("click","#step-status-button",(function(event){if($(this).parent().hasClass("open")){self.hide_step_status_filter()}else{self.show_step_status_filter();if(!IS_MOBILE){$(document).on("click.editor_step_filter",(function(e){self.hide_step_status_filter();$(document).off(".editor_step_filter")}))}}event.preventDefault()}))}}]);return SearchView}(React.Component);
