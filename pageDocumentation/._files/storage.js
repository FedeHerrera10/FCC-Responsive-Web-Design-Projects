"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function storage(options){options=_typeof(options)==="object"?options:{};this._data={};this._stack=[];this._stack_limit=typeof options.limit!=="undefined"?options.limit:50;this._key=typeof options.key!=="undefined"&&window.localStorage?options.key:"";this._on_set=typeof options.onSet==="function"?options.onSet:function(id){};this._on_remove=typeof options.onRemove==="function"?options.onRemove:function(id){};this._sync_timeout=null;if(this._key){var saved_data=JSON.parse(localStorage.getItem(this._key));if(saved_data){this._data=saved_data.data;this._stack=saved_data.stack}}this.has=function(id){return this._stack.indexOf(id)!==-1};this.get=function(id){this._renew(id);return this._data[id]};this.get_all=function(){var data=[];for(var i=0;i<this._stack.length;i++){var id=this._stack[i];data.push(this._data[id])}return data};this.set=function(id,data){if(typeof this._data[id]==="undefined"){this._stack.push(id);this._remove_lra()}this._data[id]=data;this._on_set(id);this._update_local_storage()};this.remove=function(id){var index=this._stack.indexOf(id);if(index>-1){this._stack.splice(index,1)}delete this._data[id];this._on_remove(id);this._update_local_storage()};this.clear=function(){for(var id in this._data){this._on_remove(id)}this._data={};this._stack=[];this._update_local_storage()};this._renew=function(id){var index=this._stack.indexOf(id);if(index>-1){this._stack.splice(index,1);this._stack.push(id)}};this._update_local_storage=function(){if(this._key){var self=this;clearTimeout(this._sync_timeout);this._sync_timeout=setTimeout((function(){try{localStorage.setItem(self._key,JSON.stringify({data:self._data,stack:self._stack}))}catch(e){self.clear()}}),300)}};this._remove_lra=function(){var count=this._stack.length-this._stack_limit;if(count<=0){return}for(var i=0;i<count;i++){delete this._data[this._stack[0]];this._stack.shift()}};this.remove_empty=function(){for(var id in this._data){if(this._data[id]===""){this.remove(id)}}}}
