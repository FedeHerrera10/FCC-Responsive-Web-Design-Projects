"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var TextareaView=function(_React$Component){_inherits(TextareaView,_React$Component);var _super=_createSuper(TextareaView);function TextareaView(){var _this;_classCallCheck(this,TextareaView);_this=_super.call(this);_this.state={suggestionText:""};return _this}_createClass(TextareaView,[{key:"componentDidMount",value:function componentDidMount(){crowdin.editor.textareaView=this;if(this.props.area_selector){this.bindEvents()}}},{key:"render",value:function render(){var resultTemplate=["div.invisible-textarea-wrapper",{id:"translation_wrapper"},this.getPluralTabTpl(),this.getTextareaTpl(),["div.clearfix editor-buttons-simple",["div.btn-toolbar pull-left plural-popover-container",{style:{margin:"0 15px 0 0"}},IS_MOBILE?[["button.btn btn-icon",{id:"prev_translation",tabIndex:-1,key:"prev_translation"},["i.static-icon-back"]],["button.btn btn-icon",{id:"next_translation",tabIndex:-1,key:"next_translation"},["i.static-icon-next"]]]:null,["button.btn btn-icon",{id:"action_copy_source",tabIndex:-1,title:_l("editor.copySource")},["i.static-icon-copy-source"]],IS_MOBILE?null:["button.btn btn-icon",{id:"action_clear",tabIndex:-1,title:_l("generic.clear")},["i.static-icon-trash"]],IS_MOBILE?null:["button.btn btn-icon",{id:"action_select_text",tabIndex:-1,title:_l("generic.selectText")},["i.static-icon-textbox"]],this.getPluralExamplesLinkTpl()],this.getPluralExamplesTpl(),this.getTextLengthAndSubmitButtonTpl()]];return ReactCompile(resultTemplate)}},{key:"getPluralTabTpl",value:function getPluralTabTpl(){var result=["div.nav-tabs-wrapper hide",{id:"plural_controls_container"}];if(IS_MOBILE){result.push(["div.clearfix editor-buttons-bottom",["label.pull-left muted s-margin-right",{htmlFor:"plurals_select",style:{paddingTop:"6px"}},_l("generic.form2D")],["div",{style:{overflow:"hidden"}},["select.input-block-level no-margin",{id:"plurals_select"}]]])}else{result.push(["ul.nav nav-tabs",{id:"plurals_tabs"}])}return result}},{key:"getTextareaTpl",value:function getTextareaTpl(){var targetLanguage=crowdin.editor.target_language;var textareaStyles={direction:targetLanguage?targetLanguage.text_direction:"ltr",maxHeight:IS_MOBILE?"144px":"264px"};var isFirefox=crowdin.browser.detect().name==="Firefox";if(isFirefox){textareaStyles["paddingBottom"]=0}return["textarea.input-block-level",{id:"translation",lang:targetLanguage?targetLanguage.generic_code:"",style:textareaStyles,tabIndex:2,placeholder:_l("editor.enterTranslationHere")}]}},{key:"getPluralExamplesLinkTpl",value:function getPluralExamplesLinkTpl(){return["button.btn btn-icon hide",{id:"plural-examples-link",tabIndex:-1},["i.static-icon-info"]]}},{key:"getPluralExamplesTpl",value:function getPluralExamplesTpl(){return["div.popover hidden",{id:"plural-examples-popover"},["p.small language_plural_form",_l("editor.translationWillBeUsedWithNumbers2D")+" ",["span.plural-examples"]],["p.small icu_plural_form hide"],["p.small no-margin-bottom",["a",{href:"https://en.wikipedia.org/wiki/Plural",tabIndex:-1,target:"_blank"},_l("editor.learnMoreAboutPlurals")]]]}},{key:"getTextLengthAndSubmitButtonTpl",value:function getTextLengthAndSubmitButtonTpl(){var translation=this.props.translation;return["div.editor-textarea-controls pull-right",[LettersCounter,{translation:translation,pluralId:(crowdin.translation||{}).plural_id,suggestionText:this.state.suggestionText}],["button.btn",{id:"suggest_translation",tabIndex:-1},_l("generic.save")]]}},{key:"bindEvents",value:function bindEvents(){var self=this;$("#suggest_translation").click((function(e){crowdin.translation.save_suggestion();e.preventDefault()}));$("#prev_translation").click((function(e){crowdin.translation.prev();e.preventDefault()}));$("#next_translation").click((function(e){crowdin.translation.next(true);e.preventDefault()}));$("#action_select_text").click((function(){if(crowdin.suggestions){crowdin.suggestions.suggestions_select_mode=!crowdin.suggestions.suggestions_select_mode;$(this)[crowdin.suggestions.suggestions_select_mode?"addClass":"removeClass"]("active");crowdin.editor.view.setState({})}}));$("#plural-examples-link").click((function(e){e.preventDefault()}));$(document).on("input propertychange",self.props.area_selector,(function(e,data){crowdin.translation.onEditTranslation(e,data)}));$(document).on("keypress",self.props.area_selector,(function(e){if(!crowdin.user.settings.enable_autocomplete){return true}if(e.charCode!==$.ui.keyCode.SPACE&&e.keyCode!==$.ui.keyCode.BACKSPACE&&e.keyCode!==$.ui.keyCode.ENTER&&e.charCode&&!e.ctrlKey&&!e.altKey&&!e.metaKey){crowdin.translation.openAutocomplete()}}));$(document).on("keydown",self.props.area_selector,(function(e){if(!crowdin.user.settings.enable_autocomplete){return true}if((e.keyCode===$.ui.keyCode.SPACE||e.keyCode===$.ui.keyCode.ENTER)&&!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)){crowdin.translation.closeAutocomplete()}if(e.keyCode===$.ui.keyCode.LEFT||e.keyCode===$.ui.keyCode.RIGHT||e.keyCode===$.ui.keyCode.BACKSPACE){if(crowdin.translation.area.$container.autocomplete("widget").is(":visible")){crowdin.translation.openAutocomplete()}else{crowdin.translation.closeAutocomplete()}}if(e.keyCode===$.ui.keyCode.END||e.keyCode===$.ui.keyCode.HOME){crowdin.translation.closeAutocomplete()}}));$("#plural-examples-link").popover({html:true,placement:"right",trigger:"manual",animation:false,delay:{show:100,hide:100},content:function content(){return $("#plural-examples-popover").html()}});$("#plural-examples-link").click((function(){$(this).toggleClass("active");$(this).popover($(this).hasClass("active")?"show":"hide")}))}}]);return TextareaView}(React.Component);
