"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var TranslateView=function(_React$Component){_inherits(TranslateView,_React$Component);var _super=_createSuper(TranslateView);function TranslateView(props){var _this;_classCallCheck(this,TranslateView);_this=_super.call(this,props);_this.state=_this.getInitialState();_this.onOpenOnBoarding=_this.onOpenOnBoarding.bind(_assertThisInitialized(_this));_this.removeOnboarding=_this.removeOnboarding.bind(_assertThisInitialized(_this));return _this}_createClass(TranslateView,[{key:"getInitialState",value:function getInitialState(){return{data:{},messages:[],languageId:0,translation:{},suggestions:[],externalSuggestions:[],tms:[],mts:{},assistance:[],other:[],loaded:false,isPwa:isPwa(),editTermDialogData:{source_language_name:null,target_language_name:null,term_detect_available:null,pos_mapping:{},term_data:{},dialog_type:""},onBoarding:this.props.onBoarding}}},{key:"componentDidMount",value:function componentDidMount(){crowdin.editor.view=this;crowdin.ajax.loadingBlock=$("#loading_block");crowdin.editor.trackProject();crowdin.editor.setColorTheme(crowdin.user.settings.editor_color_theme);crowdin.editor.layout=new editor_layout;crowdin.clipboard=new clipboard_events(_l("editorInit.urlCopiedToClipboard"),IS_MOBILE);if(!crowdin.editor.jipt_mode){crowdin.strings_url_filter.setFilterInitialization(true);crowdin.phrases.refresh()}}},{key:"componentDidUpdate",value:function componentDidUpdate(){crowdin.helpers.users.initUsers()}},{key:"render",value:function render(){var onBoarding=this.state.onBoarding;var resultTemplate=["div",{id:"translate-view"},["div#main_menu",[MenuView,{openOnBoarding:this.onOpenOnBoarding}]],["div#main_menu_mask"],this.getUserSudoWarningComponent(),this.getProgressBar(),this.getEditorHeaderComponent(),this.getEditorContentTpl(),["ul.phrase-dropdown",{id:"source_phrase_popup"},["li",["a",{id:"search-concordance-btn",href:"#",tabIndex:-1},_l("editor.searchTM")]],["li",["a",{id:"quick-search-term-btn",href:"#",tabIndex:-1},_l("editor.searchInGlossaryWikipedia")]],this.getGlossaryAddTermBtnTpl(),this.copyTermBtnTpl(),this.copyPasteTermBtnTpl()],this.getMobileMenusComponent(),this.getTranslateDialogs(),onBoarding?[OnBoarding,{mode:"translate",onCloseModal:this.removeOnboarding}]:null];return ReactCompile(resultTemplate)}},{key:"getUserSudoWarningComponent",value:function getUserSudoWarningComponent(){return["div",{id:"user-sudo-warning"},[UserSudoWarning]]}},{key:"getEditorHeaderComponent",value:function getEditorHeaderComponent(){return["div.navbar navbar-static-top"+(crowdin.user.is_sudo?" demo-header":""),{id:"editor-header"},[HeaderView,{isPwa:this.state.isPwa}]]}},{key:"getProgressBar",value:function getProgressBar(){return[ProgressView]}},{key:"getEditorContentTpl",value:function getEditorContentTpl(){return["div"+(crowdin.user.is_sudo?".demo-content":""),{id:"content"},this.getLeftPanelComponent(),["div.editor-panel editor-panel-right visible",{id:"right_panel"},[RightPanelView,{messages:this.state.messages,languageId:this.state.languageId}]],["div.editor-translate-field editor-center",{id:"editor-center-layout"},["div.editor-pane-mask mask-hidden"],["div.editor-pane-inner",["div",{id:"translation_container"},[TranslationView,{area_selector:"#translation",translation:this.state.translation,messages_count:this.state.messages.length}]],["div.ui-layout-content"+(crowdin.suggestions&&crowdin.suggestions.suggestions_select_mode?" suggestions-select-mode select-js-disable":""),{id:"suggestions-wrapper",tabIndex:3},[SuggestionsView,{suggestionsLoaded:Boolean(this.state.suggestionsLoaded),tmAndMtSuggestionsLoaded:Boolean(this.state.tmAndMtSuggestionsLoaded),suggestions:this.state.suggestions,externalSuggestions:this.state.externalSuggestions,tms:this.state.tms,mts:this.state.mts}],[OtherLanguagesView,{assistance:this.state.assistance,other:this.state.other,loaded:this.state.loaded}]]],this.getLeftPanelResizerTpl(),this.getRightPanelResizerTpl()]]}},{key:"getLeftPanelComponent",value:function getLeftPanelComponent(){if(crowdin.editor.jipt_mode){return null}return["div.first_block editor-panel editor-panel-left visible",{id:"left_panel"},[LeftPanelView,{data:this.state.data}]]}},{key:"getMobileMenusComponent",value:function getMobileMenusComponent(){if(!IS_MOBILE){return null}return["div",{id:"mobile-menus"},[MobileMenusView,{translation:this.state.translation}]]}},{key:"getLeftPanelResizerTpl",value:function getLeftPanelResizerTpl(){return!IS_MOBILE&&!crowdin.editor.jipt_mode?["div.editor-pane-resizer left"]:null}},{key:"getRightPanelResizerTpl",value:function getRightPanelResizerTpl(){return!IS_MOBILE?["div.editor-pane-resizer right"]:null}},{key:"getGlossaryAddTermBtnTpl",value:function getGlossaryAddTermBtnTpl(){if(!crowdin.editor.project.glossary_access&&!(crowdin.glossary&&crowdin.glossary.glossary_access)){return null}return["li",["a",{id:"quick-add-term-btn",href:"#",tabIndex:-1},_l("editor.createTerm")]]}},{key:"copyTermBtnTpl",value:function copyTermBtnTpl(){var copyToClipboard=function copyToClipboard(event){if($(event.target).data("selection")){crowdin.clipboard.successMessage=_l("editor.stringCopiedToClipboard");crowdin.clipboard.copy($(event.target).data("selection"))}crowdin.translation.hideSourcePhrasePopup();event.preventDefault()};return["li",["a",{id:"source-phrase-copy-btn",href:"#",tabIndex:-1,onClick:copyToClipboard},_l("editor.copy")]]}},{key:"copyPasteTermBtnTpl",value:function copyPasteTermBtnTpl(){var copyAndPaste=function copyAndPaste(event){if($(event.target).data("selection")){var caretPosition=crowdin.translation.area.$container.textareaHelper("getOriginalCaretPos");var selectionLength=$(event.target).data("selection").length;crowdin.translation.insertValue($(event.target).data("selection"));crowdin.translation.focus();crowdin.translation.area.container.setSelectionRange(caretPosition+selectionLength,caretPosition+selectionLength)}crowdin.translation.hideSourcePhrasePopup();event.preventDefault()};return["li",["a",{id:"source-phrase-copy-paste-btn",href:"#",tabIndex:-1,onClick:copyAndPaste},_l("editor.copyAndPaste")]]}},{key:"getTranslateDialogs",value:function getTranslateDialogs(){return[["div.hide",{id:"editor_contact_manager_dialog",key:"editor_contact_manager_dialog",title:_l("mail.composeMessage")},[ContactManagerModal]],["div",{id:"editor-context-dialogs",key:"editor-context-dialogs"},[ContextModal]],["div.hide",{id:"replace-in-suggestions",key:"replace-in-suggestions"},[ReplaceModal]],["div.hide",{id:"terms_editor",key:"terms_editor",title:"project.termDetails"},[EditTermModal,this.state.editTermDialogData]],["div.hide",{id:"dummy_dialog",key:"dummy_dialog",title:"",style:{overflow:"hidden"}}],["div.hide",{id:"download_file_dialog",key:"download_file_dialog",title:"",style:{overflow:"hidden"}}],["div.modal-menu-mask",{key:"modal-menu-mask"}]]}},{key:"onOpenOnBoarding",value:function onOpenOnBoarding(){this.setState({onBoarding:true})}},{key:"removeOnboarding",value:function removeOnboarding(){this.setState({onBoarding:false},(function(){crowdin.editor.updateOnboarding()}))}}]);return TranslateView}(React.Component);
