"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var crowdin_user=function(_CrowdinComponent){_inherits(crowdin_user,_CrowdinComponent);var _super=_createSuper(crowdin_user);function crowdin_user(){var _this;_classCallCheck(this,crowdin_user);_this=_super.call(this);_this.settings={};_this.env={translation_sort_order:0,translation_page:1,translation_pages:1,translation_found:0,translation_per_page:0,translation_index:0,translation_step_status_filter:undefined,custom_filter:{added_from:"",added_to:"",updated_from:"",updated_to:"",changed_from:"",changed_to:"",translations:"",tm_and_mt:"",approvals:"",comments:"",screenshots:"",visibility:"",qa_issues:"",labels:[],string_type:"",votes:"",votes_count:null,translated_by_user:"",not_translated_by_user:"",approved_by_user:"",not_approved_by_user:"",approved_by_step:0,approved_step:0,sort_method:0,sort_ascending:1}};_this.id=null;_this.login=null;_this.name=null;_this.timezone=null;_this.avatar_url=null;_this.saved_translation=null;_this.search_saved_translation=null;_this.saved_translation_page=1;_this.search_saved_translation_page=1;_this.is_leader=false;_this.is_manager=false;_this.is_owner=false;_this.may_download=false;_this.workflow_step_id=0;_this.can_edit_context=false;_this.unread_messages_count=0;_this.unread_notifications_count=0;_this.user_ws_hash=null;_this._default_custom_filter=$.extend({},_this.env.custom_filter);_this.inherit(INIT_USER);_this.inherit(INIT_USER_SETTINGS,_this.settings);_this.inherit(INIT_USER_ENV,_this.env);window.INIT_USER=null;window.INIT_USER_SETTINGS=null;window.INIT_USER_ENV=null;_this.bind_events();$.momentlive.defaults.locale=window.CURRENT_LOCALE;$.momentlive.defaults.timezone=_this.timezone;return _this}_createClass(crowdin_user,[{key:"get_saved_translation",value:function get_saved_translation(){return this.search_active()?this.search_saved_translation:this.saved_translation}},{key:"set_saved_translation",value:function set_saved_translation(value){this[this.search_active()?"search_saved_translation":"saved_translation"]=value}},{key:"get_saved_translation_page",value:function get_saved_translation_page(){return this.search_active()?this.search_saved_translation_page:this.saved_translation_page}},{key:"set_saved_translation_page",value:function set_saved_translation_page(value){this[this.search_active()?"search_saved_translation_page":"saved_translation_page"]=value}},{key:"search_active",value:function search_active(){return crowdin.phrases&&crowdin.phrases.query}},{key:"clear_saved_translation",value:function clear_saved_translation(storage){this[storage==="search"?"search_saved_translation":"saved_translation"]=null;this[storage==="search"?"search_saved_translation_page":"saved_translation_page"]=1}},{key:"set_texts_page",value:function set_texts_page(value){if(value>0){this.env.translation_page=value}}},{key:"get_texts_page",value:function get_texts_page(){return this.env.translation_page}},{key:"set_texts_pages",value:function set_texts_pages(value){if(value>0){this.env.translation_pages=value}}},{key:"get_texts_pages",value:function get_texts_pages(){return this.env.translation_pages}},{key:"get_texts_found",value:function get_texts_found(){return this.env.translation_found}},{key:"set_texts_found",value:function set_texts_found(value){this.env.translation_found=value}},{key:"decrease_texts_found",value:function decrease_texts_found(){this.env.translation_found--}},{key:"get_texts_per_page",value:function get_texts_per_page(){return this.env.translation_per_page}},{key:"set_texts_per_page",value:function set_texts_per_page(value){this.env.translation_per_page=value}},{key:"set_texts_index",value:function set_texts_index(index){this.env.translation_index=index}},{key:"get_texts_index",value:function get_texts_index(){return this.env.translation_index}},{key:"next_texts_index",value:function next_texts_index(){return this.env.translation_index++}},{key:"prev_texts_index",value:function prev_texts_index(){return this.env.translation_index--}},{key:"set_texts_sort_order",value:function set_texts_sort_order(value){this.env.translation_sort_order=value}},{key:"get_texts_sort_order",value:function get_texts_sort_order(){return this.env.translation_sort_order}},{key:"set_custom_filter",value:function set_custom_filter(value){this.env.custom_filter=value}},{key:"get_custom_filter",value:function get_custom_filter(){return this.env.custom_filter}},{key:"set_step_status_filter",value:function set_step_status_filter(value){this.env.translation_step_status_filter=value||undefined}},{key:"get_step_status_filter",value:function get_step_status_filter(){return this.env.translation_step_status_filter}},{key:"get_default_custom_filter",value:function get_default_custom_filter(){return $.extend({},this._default_custom_filter)}},{key:"reset_custom_filter",value:function reset_custom_filter(){this.env.custom_filter=$.extend({},this._default_custom_filter)}},{key:"get_full_name",value:function get_full_name(user){user=user||this;if(user.name&&user.name!==user.login){return user.name+" ("+user.login+")"}else{return user.login}}},{key:"get_workflow_proofread_step_id",value:function get_workflow_proofread_step_id(){var workflow_step_id=crowdin.user.workflow_step_id;if(workflow_step_id==1||$.inArray(workflow_step_id,crowdin.editor.workflow_step_ids)==-1){return crowdin.editor.workflow_step_ids[crowdin.editor.workflow_step_ids.length-1]}return workflow_step_id}},{key:"logout",value:function logout(){var logoutQuery=$.param({domain:crowdin.editor.organization.domain||"",cname:crowdin.editor.organization.cname.domain||""});crowdin.helpers.url.redirect(getCookie("jwt")?AUTH_HOST+"/logout?"+logoutQuery:"/backend/user/logout")}},{key:"update_settings",value:function update_settings(){crowdin.ajax.postData("/user_settings/update",{settings:JSON.stringify(this.settings)})}},{key:"bind_events",value:function bind_events(){var self=this;$("#logout_button").click((function(){self.logout();return false}))}},{key:"hasManagerAccessToProject",value:function hasManagerAccessToProject(){return this.is_owner||this.is_manager}}]);return crowdin_user}(CrowdinComponent);
